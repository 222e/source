!function(){function e(e){this.element=e,this.media=this.element.getElementsByClassName("js-immerse-section-tr__media"),this.scrollContent=this.element.getElementsByClassName("js-immerse-section-tr__content"),this.media.length<1||(this.figure=this.media[0].getElementsByClassName("js-immerse-section-tr__figure"),this.figure.length<1||(this.visibleFigure=!1,this.mediaScale=1,this.mediaInitHeight=0,this.elementPadding=0,this.scrollingFn=!1,this.scrolling=!1,this.active=!1,this.scrollDelta=0,function(i){(function(e){0==parseInt(window.getComputedStyle(e.element).getPropertyValue("padding-top"))&&(e.element.style.paddingTop="1px")})(i),t(i),i.element.addEventListener("update-immerse-section",function(e){t(i)}),new IntersectionObserver(function(e){if(e[0].isIntersecting){if(this.scrollingFn)return;!function(e){e.scrollingFn=function(){if(this.scrolling)return;this.scrolling=!0,window.requestAnimationFrame(s.bind(this))}.bind(e),window.addEventListener("scroll",e.scrollingFn)}(this)}else{if(!this.scrollingFn)return;window.removeEventListener("scroll",this.scrollingFn),this.scrollingFn=!1}}.bind(i)).observe(i.media[0])}(this)))}function t(e){!function(e){e.visibleFigure=!1;for(var i=0;i<e.figure.length;i++)if("none"!=window.getComputedStyle(e.figure[i]).getPropertyValue("display")){e.visibleFigure=e.figure[i];break}}(e),function(e){e.active=!0,e.visibleFigure.offsetHeight>=window.innerHeight&&(e.active=!1);600<=window.innerHeight-e.visibleFigure.offsetHeight&&(e.active=!1)}(e),e.active?(Util.removeClass(e.element,"x-niq"),function(e){e.mediaInitHeight=e.visibleFigure.offsetHeight,e.scrollDelta=window.innerHeight-e.visibleFigure.offsetHeight>window.innerWidth-e.visibleFigure.offsetWidth?(window.innerHeight-e.visibleFigure.offsetHeight)/2:(window.innerWidth-e.visibleFigure.offsetWidth)/2,e.scrollDelta>window.innerHeight&&(e.scrollDelta=window.innerHeight);e.scrollDelta<200&&(e.scrollDelta=200);e.media[0].style.height=window.innerHeight+"px",e.media[0].style.paddingTop=(window.innerHeight-e.visibleFigure.offsetHeight)/2+"px",e.media[0].style.marginTop=(e.visibleFigure.offsetHeight-window.innerHeight)/2+"px"}(e),function(e){var i=n(window.innerWidth/e.visibleFigure.offsetWidth),t=n(window.innerHeight/e.visibleFigure.offsetHeight);e.mediaScale=Math.max(i,t),e.elementPadding=parseInt(window.getComputedStyle(e.element).getPropertyValue("padding-top"))}(e),function(e){0<e.scrollContent.length&&(e.scrollContent[0].style.marginTop=e.scrollDelta+"px")}(e),s.bind(e)()):(Util.addClass(e.element,"x-niq"),e.media[0].style="",e.scrollContent[0].style="",l(e,1),r(e,0))}function n(e){return(Math.ceil(100*e)/100).toFixed(2)}function s(){if(this.active){var e=(window.innerHeight-this.mediaInitHeight)/2,i=this.element.getBoundingClientRect().top+this.elementPadding;if(i<e&&i>e-this.scrollDelta)l(this,1+(i-e)*(1-this.mediaScale)/this.scrollDelta),r(this,0);else e<=i?(l(this,1),r(this,0)):(l(this,this.mediaScale),r(this,1.8*(e-this.scrollDelta-i)/window.innerHeight));this.scrolling=!1}}function l(e,i){e.visibleFigure.style.transform="scale("+i+")",e.visibleFigure.style.msTransform="scale("+i+")"}function r(e,i){e.element.style.setProperty("--immerse-section-tr-opacity",i)}var i,o=document.getElementsByClassName("js-immerse-section-tr"),a=Util.osHasReducedMotion(),g="IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype;if(!(o.length<1))if(!a&&g){for(var d=[],h=0;h<o.length;h++)i=h,d.push(new e(o[i]));if(0<d.length){var c=!1,m=new CustomEvent("update-immerse-section");function f(){for(var e=0;e<d.length;e++)d[e].element.dispatchEvent(m)}window.addEventListener("resize",function(){clearTimeout(c),c=setTimeout(f,500)})}}else for(h=0;h<o.length;h++)Util.addClass(o[h],"x-niq")}();